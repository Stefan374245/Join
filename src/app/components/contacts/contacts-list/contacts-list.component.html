<div class="contacts-page">
	<aside class="contacts-aside">
		<div class="logo">
			<img src="assets/images/joinlogowhite.svg" alt="Join" />
		</div>

		<nav class="side-nav">
			<a routerLink="/summary">
				<img src="assets/images/summarygray.svg" alt="Summary" />
				<span>Summary</span>
			</a>
			<a routerLink="/board">
				<img src="assets/images/boardgray.svg" alt="Board" />
				<span>Board</span>
			</a>
			<a routerLink="/contacts" class="active">
				<img src="assets/images/contactswhite.svg" alt="Contacts" />
				<span>Contacts</span>
			</a>
		</nav>

		<div id="legal" class="legal">
			<a routerLink="/privacy">Privacy Policy</a>
			<a routerLink="/legal">Legal Notice</a>
		</div>
	</aside>

	<main class="contacts-main">
		<div class="content-left">
					<div class="add-btn" (click)="addContact()">
						<span>Add new contact</span>
						<img src="assets/images/person_add.svg" alt="add" />
			</div>

			<!-- Debug Info -->
			<!-- <div style="padding: 10px; background: #f0f0f0; margin: 10px 0;">
				<small>Debug: Contacts count: {{ (contacts$ | async)?.length || 0 }} | Groups count: {{ (grouped$ | async)?.length || 0 }}</small>
			</div> -->

			<div id="allContacts" class="all-contacts">
				<ng-container *ngIf="grouped$ | async as groups; else loading">
					<ng-container *ngIf="groups.length > 0; else noContacts">
						<ng-container *ngFor="let g of groups">
							<div class="capital">
								<span class="spanLetter">{{ g.letter }}</span>
								<div class="separator"></div>
							</div>

							<ng-container *ngFor="let user of g.items; index as i">
								<nav class="singleUser" [class.singleUserChosen]="selected?.email === user.email" (click)="select(user)">
									<span class="userInitials" [ngStyle]="{'background-color': user.color}">{{ user.initials }}</span>
									<div class="userDetails">
										<span class="userName">{{ user.firstName }} {{ user.lastName }}</span>
										<a class="emailText" [href]="'mailto:' + user.email">{{ user.email }}</a>
									</div>
								</nav>
							</ng-container>
						</ng-container>
					</ng-container>
					<ng-template #noContacts>
						<div class="empty-message">
							<p>No contacts available. Register users to see them here.</p>
						</div>
					</ng-template>
				</ng-container>
				<ng-template #loading>
					<div class="loading-message">
						<p>Loading contacts...</p>
					</div>
				</ng-template>
			</div>
		</div>

		<div class="content-right" [class.hidden-xs]="!showRight">
			<div class="frame-40">
				<div class="contactsFrame">
					<h1>Contacts</h1>
					<div class="separator"></div>
					<p>Better with a team</p>
				</div>
			</div>

			<section class="contact-details" *ngIf="selected; else emptyState">
				<div class="contactDetailsPerson">
					<span class="userInitialsBig" [ngStyle]="{'background-color': selected.color}">{{ selected.initials }}</span>
					<section>
						<p id="contactDetailsName">{{ selected.firstName }} {{ selected.lastName }}</p>
						<div id="basicManipulate">
							<button class="btn-link" (click)="editContact(selected)">
								<img src="assets/images/edit-2.svg" alt="Edit" class="icon-default" />
								<img src="assets/images/edit-1.svg" alt="Edit" class="icon-hover" />
								<span>Edit</span>
							</button>
							<button class="btn-link" (click)="deleteContact(selected.email)">
								<img src="assets/images/delete.svg" alt="Delete" class="icon-default" />
								<img src="assets/images/delete-blue.svg" alt="Delete" class="icon-hover" />
								<span>Delete</span>
							</button>
						</div>
					</section>
				</div>

				<div class="contactInformations">
					<p>Contact Information</p>
					<strong>Email</strong>
					<a class="contactDetailsMail" id="contactDetailsMail" [href]="'mailto:' + selected.email">{{ selected.email }}</a>
					<strong>Phone</strong>
					<span id="contactDetailsPhone">{{ selected.phone || '-' }}</span>
				</div>
			</section>

			<ng-template #emptyState>
				<div class="empty-state">
					<p>Select a contact to see details</p>
				</div>
			</ng-template>
		</div>
	</main>

	<!-- Contact Dialog -->
	<app-contact-dialog
		*ngIf="showDialog"
		[mode]="dialogMode"
		[contact]="dialogContact"
		(close)="closeDialog()"
		(save)="saveContact($event)"
		(delete)="deleteContact($event)">
	</app-contact-dialog>
</div>

